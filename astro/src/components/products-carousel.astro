---
import { Icon } from "astro-icon/components";
import type { TiendaNubeProduct } from "../modules/store/tiendanube/types";
import { getProducts, formatPrice } from "../modules/store/tiendanube/utils";
import NewsletterBrownMountain from "./svg/newsletter-brown-mountain.astro";
import Trees from "./svg/trees.astro";

const products: TiendaNubeProduct[] | null = await getProducts();
---

<div class="relative z-20 py-20">
  <div class="absolute z-0 left-0 -bottom-16 w-full">
    <Trees />
  </div>

  <div class="">
    <div class="max-w-4xl mx-auto px4">
      <div class="scroll-container snap-x snap-mandatory">
        <div
          class="flex gap-6 md:gap-8 min-w-max md:min-w-0 md:grid md:grid-cols-3"
        >
          {
            products?.map((product) => (
              <article class="snap-center shrink-0 z-10 w-64 md:w-auto bg-white p-4 shadow-news-card">
                <div class="group">
                  <div class="relative aspect-square mb-4">
                    <img
                      src={product.images[0].src}
                      alt="Kite Completo"
                      class="w-full h-full object-cover opacity-90 group-hover:opacity-100 transition-opacity duration-300"
                    />

                    <div class="absolute z-30 -bottom-4 right-4 bg-brand-blue border-4 border-white size-8 rounded-full text-white flex items-center justify-center">
                      <a
                        href={product.canonical_url}
                        target="_blank"
                        rel="noopener noreferrer"
                      >
                        <Icon name="move-up-right" />
                      </a>
                    </div>
                  </div>
                  <h3 class="text-lg font-bold uppercase mb-1 text-brand-blue">
                    {product.name.es}
                  </h3>
                  <p class="text-xl text-brand-blue">
                    {formatPrice(product.variants[0].price)}
                  </p>
                </div>
              </article>
            ))
          }
        </div>

        <div class="relative z-20 flex justify-center pt-10">
          <a
            class="bg-brand-red text-white font-bold w-1/3 text-center py-2 rounded-md"
            href="https://faunakite.mitiendanube.com/"
            target="_blank"
            rel="noopener noreferrer">VISITA LA TIENDA</a
          >
        </div>
      </div>
    </div>
  </div>
</div>
