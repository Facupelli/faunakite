---
import type { TiendaNubeProduct } from "../modules/store/tiendanube/types";
import { getProducts } from "../modules/store/tiendanube/utils";
import { useTranslations } from "../i18n/utils";
import { storeUrl } from "../modules/store/constants";
import ProductCarousel from "./products-carrousel";

const products: TiendaNubeProduct[] | null = await getProducts();

const lang = Astro.params.locale as "en" | "es";
const t = useTranslations(lang);
---

<section class="relative z-20 py-20">
  <div
    class="relative max-w-5xl mx-auto px-4 lg:px-10 overflow-x-hidden overflow-y-hidden lg:overflow-visible"
  >
    <div class="text-center mb-16">
      <h2 class="text-4xl md:text-5xl font-salted text-brand-red mb-4">
        {t("products.title")}
      </h2>
      <!-- <p class="text-lg text-slate-600 max-w-2xl mx-auto">
        {t("products.subtitle")}
      </p> -->
    </div>

    <div class="hidden md:block absolute lg:-left-10 xl:-left-32 -top-2 z-20">
      <svg
        class="w-full max-w-2xl mx-auto"
        viewBox="100 300 800 300"
        xmlns="http://www.w3.org/2000/svg"
      >
        <!-- Define the invisible path -->
        <defs>
          <!-- Original path: M 1 -1 Q 214 -327 341 -2 -->
          <!-- Scale factor: ~2.35 to fit nicely, then shift to positive space -->
          <path id="arcPath" d="M 100 750 Q 600 50 900 745"></path>
        </defs>

        <!-- Text that follows the path -->
        <text
          font-size="74"
          fill="currentColor"
          font-weight="600"
          letter-spacing="5"
        >
          <textPath
            href="#arcPath"
            startOffset="50%"
            text-anchor="middle"
            class="font-salted text-brand-blue"
          >
            CUESTA DEL VIENTO
          </textPath>
        </text>
      </svg>
    </div>

    <ProductCarousel products={products} client:load />

    <!-- SVG PATH 2 -->
    <div
      class="hidden md:block absolute -right-4 lg:-right-8 xl:-right-30 -bottom-4 z-10"
    >
      <svg
        class="w-full max-w-3xl mx-auto"
        viewBox="100 -200 900 1000"
        xmlns="http://www.w3.org/2000/svg"
      >
        <!-- Define the invisible path -->
        <defs>
          <path
            id="arcDondeSiempreSopla"
            d="M101 631Q146 742 355 748 603 733 797 432"></path>
        </defs>

        <!-- Text that follows the path -->
        <text
          font-size="80"
          fill="currentColor"
          font-weight="600"
          letter-spacing="3"
        >
          <textPath
            href="#arcDondeSiempreSopla"
            startOffset="50%"
            text-anchor="middle"
            class="font-salted text-brand-blue"
          >
            DONDE SIEMPRE SOPLA
          </textPath>
        </text>

        <text
          x="950"
          y="570"
          font-size="80"
          fill="currentColor"
          font-weight="600"
          letter-spacing="3"
          class="font-salted text-brand-blue"
          transform="rotate(-70 740 570)"
        >
          A
        </text>

        <text
          x="800"
          y="170"
          font-size="80"
          fill="currentColor"
          font-weight="600"
          letter-spacing="3"
          class="font-salted text-brand-blue"
        >
          A
        </text>

        <text
          x="1000"
          y="120"
          font-size="80"
          fill="currentColor"
          font-weight="600"
          letter-spacing="3"
          class="font-salted text-brand-blue"
          transform="rotate(-40 800 170)"
          opacity="0.85"
        >
          A
        </text>
      </svg>
    </div>

    <div class="relative z-20 flex justify-center pt-10">
      <a
        class="bg-brand-red text-white font-bold md:w-1/3 px-6 text-center py-2 rounded-md"
        href={storeUrl}
        target="_blank"
        rel="noopener noreferrer">{t("store.button")}</a
      >
    </div>
  </div>
</section>
