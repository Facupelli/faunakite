---
import Layout from "../../../layouts/Layout.astro";
import type { Booking } from "../../../booking/booking.entity";
import { getBookingById } from "../../../booking/use-cases/find-booking-by-id";
import BookingNotFound from "../../../components/verify/booking-not-found.astro";
import VerificationCard from "../../../components/verify/verification-card.astro";

export const prerender = false;

const { bookingId } = Astro.params;

let booking: Booking | null = null;
if (bookingId) {
  booking = await getBookingById(bookingId);
}

console.log({ booking });

if (!booking) {
  Astro.response.status = 404;
}
---

<Layout title="Verificar Alumno">
  <div class="mx-auto max-w-3xl px-4 py-12 sm:px-6 lg:px-8">
    {
      booking ? (
        <VerificationCard
          studentName={booking.customerName}
          courseName={booking.courseType}
          expiryDate={booking.departureDate.toISOString()}
        />
      ) : (
        <BookingNotFound bookingId={bookingId} />
      )
    }
  </div>
</Layout>
