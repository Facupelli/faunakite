---
import { useTranslations } from "../../../i18n/utils";
import ServicesLayout from "../../../layouts/services-layout.astro";

export async function getStaticPaths() {
  return [{ params: { locale: "en" } }, { params: { locale: "es" } }];
}

const lang = Astro.params.locale as "en" | "es";
const t = useTranslations(lang);
---

<ServicesLayout>
  <Fragment slot="header">
    <div class="max-w-6xl mx-auto pb-30">
      <div class="space-y-8 text-white text-lg md:text-xl px-4">
        <p>
          {t("services.intro.p1")}
        </p>

        <p>
          {t("services.intro.p2")}
        </p>
      </div>
    </div>
  </Fragment>

  <div class="px-4 md:px-10 space-y-20 pt-10" id="courses-container">
    <!-- CURSOS -->
    <div class="flex flex-col gap-10">
      <div class="">
        <h2 class="text-4xl text-brand-blue font-bold">
          {t("services.kite.classes.title")}
        </h2>
      </div>
      <div class="grid md:grid-cols-2 gap-10 items-start">
        <!-- CURSO INICIAL -->
        <div
          class="text-brand-blue flex flex-col-reverse md:flex-row gap-6"
          data-course-type="curso-inicial"
        >
          <div class="relative md:basis-[33%] flex overflow-hidden">
            <img
              src="https://images.pexels.com/photos/10087765/pexels-photo-10087765.jpeg?_gl=1*1prvhrg*_ga*MTk3MDY0MTc3NS4xNzY2MDA1OTE5*_ga_8JE65Q40S6*czE3NjYwNjUyMjkkbzIkZzEkdDE3NjYwNjUyODMkajYkbDAkaDA."
              class="md:absolute md:inset-0 rounded-md filter-bluish-dark w-full h-full object-cover"
            />
          </div>

          <div class="md:basis-[66%]">
            <h2 class="font-bold text-2xl pb-2">
              {t("services.kite.initial.title")}
            </h2>
            <div class="space-y-1">
              <p>
                <strong>{t("services.common.duration")}:</strong>
                {t("services.kite.initial.duration")}
              </p>
              <p>
                <strong>{t("services.common.level")}:</strong>
                {t("services.kite.initial.level")}
              </p>
              <p>
                <strong>{t("services.common.mode")}:</strong>
                {t("services.kite.initial.mode")}
              </p>
            </div>
            <div class="relative">
              <div
                class="space-y-2 pt-2 expandable-content"
                data-expanded="false"
              >
                <p>
                  {t("services.kite.initial.p1")}
                </p>
                <div class="expandable-text space-y-2">
                  <p>
                    {t("services.kite.initial.p2")}
                  </p>
                  <p>
                    {t("services.kite.initial.p3")}
                  </p>
                  <p>
                    {t("services.kite.initial.p4")}
                  </p>
                  <p>
                    {t("services.kite.initial.p5")}
                  </p>
                </div>
              </div>
              <div class="flex flex-col gap-3 mt-3">
                <button
                  class="expand-btn text-brand-blue font-semibold hover:underline focus:outline-none focus:ring-2 focus:ring-brand-blue focus:ring-offset-2 rounded text-left"
                  aria-expanded="false"
                >
                  {t("services.common.seeMore")}
                </button>
                <div>
                  <a
                    class="whatsapp-btn hover:bg-brand-red inline-block text-center bg-brand-blue text-white font-bold py-2 px-6 rounded-lg hover:bg-opacity-80 transition-all focus:outline-none focus:ring-2 focus:ring-brand-blue focus:ring-offset-2"
                    href="#"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    {t("services.common.book")}
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- CURSO INTENSIVO -->
        <div
          class="text-brand-blue flex flex-col-reverse md:flex-row gap-6"
          data-course-type="curso-intensivo"
        >
          <div class="relative md:basis-[33%] flex overflow-hidden">
            <img
              src="https://images.pexels.com/photos/18555969/pexels-photo-18555969.jpeg?_gl=1*erz5t8*_ga*MTk3MDY0MTc3NS4xNzY2MDA1OTE5*_ga_8JE65Q40S6*czE3NjYwNjUyMjkkbzIkZzEkdDE3NjYwNjU0NzgkajUxJGwwJGgw"
              class="rounded-md filter-bluish-dark md:absolute md:inset-0 w-full h-full object-cover"
            />
          </div>

          <div class="md:basis-[66%]">
            <h2 class="font-bold text-2xl pb-2">
              {t("services.kite.intensive.title")}
            </h2>
            <div class="space-y-1">
              <p>
                <strong>{t("services.common.duration")}:</strong>
                {t("services.kite.intensive.duration")}
              </p>
              <p>
                <strong>{t("services.common.level")}:</strong>
                {t("services.kite.intensive.level")}
              </p>
              <p>
                <strong>{t("services.common.mode")}:</strong>
                {t("services.kite.intensive.mode")}
              </p>
            </div>
            <div class="relative">
              <div
                class="space-y-2 pt-2 expandable-content"
                data-expanded="false"
              >
                <p>
                  {t("services.kite.intensive.p1")}
                </p>
                <div class="expandable-text space-y-2">
                  <p>
                    {t("services.kite.intensive.p2")}
                  </p>
                  <p>
                    {t("services.kite.intensive.p3")}
                  </p>
                </div>
              </div>
              <div class="flex flex-col gap-3 mt-3">
                <button
                  class="expand-btn text-brand-blue font-semibold hover:underline focus:outline-none focus:ring-2 focus:ring-brand-blue focus:ring-offset-2 rounded text-left"
                  aria-expanded="false"
                >
                  {t("services.common.seeMore")}
                </button>
                <div>
                  <a
                    class="whatsapp-btn hover:bg-brand-red inline-block text-center bg-brand-blue text-white font-bold py-2 px-6 rounded-lg hover:bg-opacity-80 transition-all focus:outline-none focus:ring-2 focus:ring-brand-blue focus:ring-offset-2"
                    href="#"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    {t("services.common.book")}
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- CLASES -->
    <div class="flex flex-col gap-10">
      <div class="">
        <h2 class="text-4xl text-brand-blue font-bold">
          {t("services.kite.classes.title")}
        </h2>
      </div>
      <div class="grid md:grid-cols-2 gap-10 items-start">
        <!-- CLASE INDIVIDUAL -->
        <div
          class="text-brand-blue flex flex-col-reverse md:flex-row gap-6"
          data-course-type="clase-individual"
        >
          <div class="md:basis-[33%] relative flex overflow-hidden">
            <img
              src="https://images.unsplash.com/photo-1578060124065-41f863eb9ebe?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              class="rounded-md filter-bluish-dark md:absolute md:inset-0 w-full h-full object-cover"
            />
          </div>

          <div class="md:basis-[66%]">
            <h2 class="font-bold text-2xl pb-2">
              {t("services.kite.class.individual.title")}
            </h2>
            <div class="space-y-1">
              <p>
                <strong>{t("services.common.duration")}:</strong>
                {t("services.kite.class.individual.duration")}
              </p>
              <p>
                <strong>{t("services.common.level")}:</strong>
                {t("services.kite.class.individual.level")}
              </p>
            </div>
            <div class="relative">
              <div
                class="space-y-2 pt-2 expandable-content"
                data-expanded="false"
              >
                <p>
                  {t("services.kite.class.individual.p1")}
                </p>
                <div class="expandable-text">
                  <p>
                    {t("services.kite.class.individual.p2")}
                  </p>
                </div>
              </div>
              <div class="flex flex-col gap-3 mt-3">
                <button
                  class="expand-btn text-brand-blue font-semibold hover:underline focus:outline-none focus:ring-2 focus:ring-brand-blue focus:ring-offset-2 rounded text-left"
                  aria-expanded="false"
                >
                  {t("services.common.seeMore")}
                </button>
                <div>
                  <a
                    class="whatsapp-btn hover:bg-brand-red inline-block text-center bg-brand-blue text-white font-bold py-2 px-6 rounded-lg hover:bg-opacity-80 transition-all focus:outline-none focus:ring-2 focus:ring-brand-blue focus:ring-offset-2"
                    href="#"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    {t("services.common.book")}
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- CLASE AVANZADA -->
        <div
          class="text-brand-blue flex flex-col-reverse md:flex-row gap-6"
          data-course-type="clase-avanzada"
        >
          <div class="md:basis-[33%] relative flex overflow-hidden">
            <img
              src="https://images.unsplash.com/photo-1620152174993-40a74a7e24c2?q=80&w=1364&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              class="rounded-md filter-bluish-dark md:absolute md:inset-0 w-full h-full object-cover"
            />
          </div>

          <div class="md:basis-[66%]">
            <h2 class="font-bold text-2xl pb-2">
              {t("services.kite.class.advanced.title")}
            </h2>
            <div class="space-y-1">
              <p>
                <strong>{t("services.common.duration")}:</strong>
                {t("services.kite.class.advanced.duration")}
              </p>
              <p>
                <strong>{t("services.common.level")}:</strong>
                {t("services.kite.class.advanced.level")}
              </p>
            </div>
            <div class="relative">
              <div
                class="space-y-2 pt-2 expandable-content"
                data-expanded="false"
              >
                <p>
                  {t("services.kite.class.advanced.p1")}
                </p>
                <div class="expandable-text space-y-2">
                  <p>
                    {t("services.kite.class.advanced.p2")}
                  </p>
                  <p>
                    {t("services.kite.class.advanced.p3")}
                  </p>
                  <p>
                    {t("services.kite.class.advanced.p4")}
                  </p>
                </div>
              </div>
              <div class="flex flex-col gap-3 mt-3">
                <button
                  class="expand-btn text-brand-blue font-semibold hover:underline focus:outline-none focus:ring-2 focus:ring-brand-blue focus:ring-offset-2 rounded text-left"
                  aria-expanded="false"
                >
                  {t("services.common.seeMore")}
                </button>
                <div>
                  <a
                    class="whatsapp-btn hover:bg-brand-red inline-block text-center bg-brand-blue text-white font-bold py-2 px-6 rounded-lg hover:bg-opacity-80 transition-all focus:outline-none focus:ring-2 focus:ring-brand-blue focus:ring-offset-2"
                    href="#"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    {t("services.common.book")}
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- CLASE DE PRUEBA -->
        <div
          class="text-brand-blue flex flex-col-reverse md:flex-row gap-6"
          data-course-type="clase-prueba"
        >
          <div class="md:basis-[33%] relative flex overflow-hidden">
            <img
              src="https://images.unsplash.com/photo-1627988114935-406dadb71002?q=80&w=2071&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              class="rounded-md filter-bluish-dark md:absolute md:inset-0 w-full h-full object-cover"
            />
          </div>

          <div class="md:basis-[66%]">
            <h2 class="font-bold text-2xl pb-2">
              {t("services.kite.class.try.title")}
            </h2>
            <div class="space-y-1">
              <p>
                <strong>{t("services.common.duration")}:</strong>
                {t("services.kite.class.try.duration")}
              </p>
              <p>
                <strong>{t("services.common.level")}:</strong>
                {t("services.kite.class.try.level")}
              </p>
            </div>
            <div class="relative">
              <div
                class="space-y-2 pt-2 expandable-content"
                data-expanded="false"
              >
                <p>
                  {t("services.kite.class.try.p1")}
                </p>
                <div class="expandable-text">
                  <p>
                    {t("services.kite.class.try.p2")}
                  </p>
                </div>
              </div>
              <div class="flex flex-col gap-3 mt-3">
                <button
                  class="expand-btn text-brand-blue font-semibold hover:underline focus:outline-none focus:ring-2 focus:ring-brand-blue focus:ring-offset-2 rounded text-left"
                  aria-expanded="false"
                >
                  {t("services.common.seeMore")}
                </button>
                <div>
                  <a
                    class="whatsapp-btn hover:bg-brand-red inline-block text-center bg-brand-blue text-white font-bold py-2 px-6 rounded-lg hover:bg-opacity-80 transition-all focus:outline-none focus:ring-2 focus:ring-brand-blue focus:ring-offset-2"
                    href="#"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    {t("services.common.book")}
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- WINGFOIL -->
    <div class="flex flex-col gap-10">
      <div class="">
        <h2 class="text-4xl text-brand-blue font-bold">
          {t("services.wingfoil.title")}
        </h2>
      </div>
      <div class="grid md:grid-cols-2 gap-10 items-start">
        <!-- CLASE DE WINGFOIL -->
        <div
          class="text-brand-blue flex flex-col-reverse md:flex-row gap-6"
          data-course-type="clase-wingfoil"
        >
          <div class="md:basis-[33%] relative flex overflow-hidden">
            <img
              src="https://images.unsplash.com/photo-1666175497565-1c366074f2b2?q=80&w=987&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              class="rounded-md filter-bluish-dark md:absolute md:inset-0 w-full h-full object-cover"
            />
          </div>

          <div class="md:basis-[66%]">
            <h2 class="font-bold text-2xl pb-2">
              {t("services.wingfoil.class.title")}
            </h2>
            <div class="relative">
              <div class="space-y-2 expandable-content" data-expanded="false">
                <p>{t("services.wingfoil.class.p1")}</p>
                <div class="expandable-text space-y-2">
                  <p>
                    {t("services.wingfoil.class.p2")}
                  </p>
                  <p>
                    {t("services.wingfoil.class.p3")}
                  </p>
                  <p>
                    {t("services.wingfoil.class.p4")}
                  </p>
                  <p>
                    {t("services.wingfoil.class.p5")}
                  </p>
                </div>
              </div>
              <div class="flex flex-col gap-3 mt-3">
                <button
                  class="expand-btn text-brand-blue font-semibold hover:underline focus:outline-none focus:ring-2 focus:ring-brand-blue focus:ring-offset-2 rounded text-left"
                  aria-expanded="false"
                >
                  {t("services.common.seeMore")}
                </button>
                <div>
                  <a
                    class="whatsapp-btn hover:bg-brand-red inline-block text-center bg-brand-blue text-white font-bold py-2 px-6 rounded-lg hover:bg-opacity-80 transition-all focus:outline-none focus:ring-2 focus:ring-brand-blue focus:ring-offset-2"
                    href="#"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    {t("services.common.book")}
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ServicesLayout>

<style>
  .expandable-text {
    max-height: 0;
    overflow: hidden;
    transition:
      max-height 0.6s ease-out,
      opacity 0.4s ease-out;
    opacity: 0;
  }

  .expandable-content[data-expanded="true"] .expandable-text {
    max-height: 1000px;
    opacity: 1;
    transition:
      max-height 0.6s ease-in,
      opacity 0.4s ease-in;
  }
</style>

<script>
  import { initializeWhatsAppButtons } from "../../../modules/utils/whatsapp";

  const courseMessages = {
    "curso-inicial": `¡Hola! Mi nombre es: _____
Me gustaría tomar el *Curso Inicial de 9hs* con ustedes en *Cuesta del Viento*
Voy: Solo/a / con __ personas más
Fechas: _____
¿Tienen disponibilidad? ¡Gracias!`,
    "curso-intensivo": `¡Hola! Mi nombre es: _____
Me gustaría tomar *6 hs de clase* con ustedes en *Cuesta del Viento*
Mi nivel es: _____
Voy: Solo/a / con __ personas más
Fechas: _____
¿Tienen disponibilidad? ¡Gracias!`,
    "clase-individual": `¡Hola! Mi nombre es: _____
Me gustaría reservar una *Clase Individual/Avanzada* con ustedes en *Cuesta del Viento*
Mi nivel es: _____
Viajo: Solo/a / con __ personas más
Fechas: _____
Objetivos: _____
¿Tienen disponibilidad? ¡Gracias!`,
    "clase-avanzada": `¡Hola! Mi nombre es: _____
Me gustaría reservar una *Clase Individual/Avanzada* con ustedes en *Cuesta del Viento*
Mi nivel es: _____
Viajo: Solo/a / con __ personas más
Fechas: _____
Objetivos: _____
¿Tienen disponibilidad? ¡Gracias!`,
    "clase-prueba": `¡Hola! Mi nombre es: _____
Me gustaría agendar una *Clase de Prueba* con FAUNA en *Cuesta del Viento*
Mis fechas posibles son: _____
¿Tienen disponibilidad? ¡Gracias!`,
    "clase-wingfoil": `¡Hola! Mi nombre es: _____
Me gustaría tomar una *Clase de Wingfoil* con ustedes en *Cuesta del Viento*
Mi nivel es: _____
Voy: Solo/a / con __ personas más
Fechas: _____
¿Tienen disponibilidad? ¡Gracias!`,
  };

  // Expandable content handler
  function initializeExpandable() {
    const container: HTMLElement | null =
      document.getElementById("courses-container");

    container?.addEventListener("click", (e) => {
      if (!(e.target instanceof HTMLElement)) {
        return;
      }

      const btn = e.target?.closest(".expand-btn");
      if (!btn) {
        return;
      }

      const content = btn.closest(".flex")?.previousElementSibling;
      if (!content || !content.classList.contains("expandable-content")) {
        return;
      }

      const isExpanded = content.getAttribute("data-expanded") === "true";

      content.setAttribute("data-expanded", isExpanded ? "false" : "true");
      btn.textContent = isExpanded ? "Ver más" : "Ver menos";
      btn.setAttribute("aria-expanded", String(!isExpanded));
    });
  }

  // Initialize on page load
  document.addEventListener("astro:page-load", () => {
    initializeWhatsAppButtons(courseMessages);
    initializeExpandable();
  });
</script>
